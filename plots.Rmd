
```{r}
# Descriptive table
library(tidyverse)

dig.df<-read_csv("DIG.csv",
                 col_types = "nnnnnnnnnnnnnnnnn")

dig.df<- select(dig.df, "ID", "TRTMT", "AGE", "SEX", "BMI", "CREAT",
         "DIABP", "SYSBP", "HYPERTEN", "CVD", "WHF", "HOSP", 
         "HOSPDAYS", "DEATH", "DEATHDAY")
dig.df <- na.omit(dig.df)

colnames(dig.df)[1] <- "ID" 

dig.df <- dig.df
#TRTMT
dig.df$TRTMT <- as.numeric(as.character(dig.df$TRTMT))
dig.df$TRTMT<- factor(dig.df$TRTMT,
                     levels = c(0,1),
                     labels = c("placebo", "Digoxin"))

#SEX
dig.df$SEX <- as.numeric(as.character(dig.df$SEX))
dig.df$SEX<- factor(dig.df$SEX,
                     levels = c(1,2),
                     labels = c("Male", "Female")) 

dig.df$CVD <- factor(dig.df$CVD ,
                      levels = c(0 , 1), 
                      labels = c("No", "Yes"))
# WHF
dig.df$WHF <- factor(dig.df$WHF,
                     levels  = c(0,1), 
                      labels= c("Not Worsening HF", "Worsening HF"))

dig.df$HOSP <- factor(dig.df$HOSP,
                      levels  = c(0,1), 
                      labels= c("Not Hospitalized", "Hospitalized"))
#HYPERTEN
dig.df$HYPERTEN <- as.numeric(as.character(dig.df$HYPERTEN))
dig.df$HYPERTEN<- factor(dig.df$HYPERTEN,
                     levels = c(0,1),
                     labels = c("Not Hypertensive", "Hypertensive")) 

#DEATH
dig.df$DEATH <- as.numeric(as.character(dig.df$DEATH))
dig.df$DEATH<- factor(dig.df$DEATH,
                     levels = c(0,1),
                     labels = c("Alive", "Death")) 

dig.df
```
Instead of selecting the columns here, i did the cooking in the Assignment 4 then i just brought the output here.I will try to change the title of the columns later, to be more discernable. 
```{r}
#Plot 2 
#Hospitalization due to CVD
dig.df %>% ggplot(aes(x=CVD, fill = factor(TRTMT))) + 
  labs(x="Treatment",
       title="Hospitalisation between treatment groups") +
  scale_fill_manual(values = c("#669933", "#FFCC66"),
    name = "Treatment group") +
  geom_bar(alpha=0.7, position="fill") +
  labs(x="Hospitalization for CVD",title = "Hospitalization in due to CVD in each")
```


```{r}
# Plot 3
# Hospitalisation due to WHF
dig.df %>% ggplot(aes(x=WHF, fill = factor(TRTMT))) + 
  labs(x="Treatment",
       title="Hospitalisation between treatment groups") +
  scale_fill_manual(values = c("#f09c1b", "#4f78b4"),
    name = "Treatment group") +
  geom_bar(alpha=0.7, position="fill") +
  labs(x="Hospitalization for CVD",title = "Hospitalization due to WHF in treatment groups")

```

```{r}
#Plot 4
#Death due to CVD
library(tidyr)
library(plotly)
             
cvd_mortality_by_treatment<- dig.df%>%
  group_by(TRTMT, CVD)%>%
  summarise(
    Total = n(),
    Deaths = sum(DEATH== "Death", na.rm = T),
    Mortality_Rate = Deaths/Total
  )
cvd_mortality_by_treatment


cvd_plot_strat<- ggplot(cvd_mortality_by_treatment,
                        aes(x = CVD, y=Mortality_Rate , fill = TRTMT))+
  #using position dodge to place each treatment groups side by side
  geom_col(position = position_dodge(width = 0.8), color = "lightblue")+
   scale_y_continuous(labels = scales::percent)+
  scale_fill_manual(values = c("#8970b3", "#2d7e74"))+
  labs(
    title = "Mortality rate by CVD status in each treatment group ",
    x = "Cardiovascular Disease(CVD) status",
    y = "Mortality Rate(%)",
    fill = "Treatment Group",
    caption = "\n Mortality rate by among patients with and without CVD in each treatment group")


cvd_plot_strat
ggplotly(cvd_plot_strat)
```

```{r}
#Death due to WHF
library(tidyr)
             
whf_mortality_by_treatment<- dig.df%>%
  group_by(TRTMT, WHF)%>%
  summarise(
    Total = n(),
    Deaths = sum(DEATH== "Death", na.rm = T),
    Mortality_Rate = Deaths/Total
  )
whf_mortality_by_treatment
whf_plot_strat<- ggplot(whf_mortality_by_treatment,
                        aes(x = WHF, y=Mortality_Rate , fill = TRTMT))+
  #using position dodge to place each treatment groups side by side
  geom_col(position = position_dodge(width = 0.8), color = "lightblue")+
   scale_y_continuous(labels = scales::percent)+
  scale_fill_manual(values = c("#8970b3", "#e74"))+
  labs(
    title = "Mortality rate by Worsening Heart Failure in each treatment group ",
    x = "Worsening Heart Failure(WHF) status",
    y = "Mortality Rate(%)",
    fill = "Treatment Group",
    caption = "\n Mortality rate by among patients with and without Worsening Heart Failure in each treatment group")
whf_plot_strat

ggplotly(whf_plot_strat)
```


```{r}
#Plot 6
#Survival 
```

```{r}
#Plot5
#Scatter

```

